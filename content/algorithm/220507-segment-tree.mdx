---
title: "[JS] Segment Tree"
date: "2022-05-07 00:34"
emoji: "ğŸª´"
category: "algorithm"
---

## Segment Tree(êµ¬ê°„ íŠ¸ë¦¬)?
êµ¬ê°„ íŠ¸ë¦¬ëŠ” ë°°ì—´ì˜ **íŠ¹ì • êµ¬ê°„ì— ëŒ€í•œ ì§ˆì˜ë¥¼ ë¹ ë¥´ê²Œ**í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ì–´ë–¤ êµ¬ê°„ì˜ ìµœì†Œì¹˜ë¥¼ êµ¬í•˜ê³  ì‹¶ë‹¤ê³  í•´ë³´ì.
ë³´í†µ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ êµ¬ê°„ ë‚´ ìˆ«ìë¥¼ í•˜ë‚˜í•˜ë‚˜ í™•ì¸í•˜ë©´ì„œ ìµœì†Œì¹˜ë¥¼ ì°¾ëŠ” ê²ƒìœ¼ë¡œ, $O(N)$ì˜ ì‹œê°„ì´ ê±¸ë¦°ë‹¤.
ì´ë•Œ ë°°ì—´ì„ ì „ì²˜ë¦¬í•´ êµ¬ê°„ íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ $O(N\log N)ì˜ ì‹œê°„ì— ì°¾ì„ ìˆ˜ ìˆë‹¤.

êµ¬ê°„ íŠ¸ë¦¬ëŠ” **'ì£¼ì–´ì§„ ë°°ì—´ì˜ êµ¬ê°„ë“¤ì„ í‘œí˜„'**í•˜ëŠ” ì´ì§„ íŠ¸ë¦¬ë¥¼ ë§Œë“ ë‹¤.
ë£¨íŠ¸ëŠ” ë°°ì—´ì˜ ì „ì²´êµ¬ê°„ì„ í‘œí˜„í•˜ê³ , í•œ íŠ¸ë¦¬ì˜ ì™¼ìª½ ìì‹ê³¼ ì˜¤ë¥¸ìª½ ìì‹ì€ í•´ë‹¹ êµ¬ê°„ì˜ ì™¼ìª½ ë°˜ê³¼ ì˜¤ë¥¸ìª½ ë°˜ì„ í‘œí˜„í•œë‹¤.
ê° ë…¸ë“œëŠ” í•´ë‹¹ êµ¬ê°„ì— ëŒ€í•œ ê³„ì‚° ê²°ê³¼ë¥¼ ì €ì¥í•´ë‘”ë‹¤.

ì´ë ‡ê²Œ ì „ì²˜ë¦¬í•´ë‘” íŠ¸ë¦¬ê°€ ìˆë‹¤ë©´ ì–´ë–¤ êµ¬ê°„ `[i, j]`ê°€ ì£¼ì–´ì§€ë©´ ì´ êµ¬ê°„ì„ êµ¬ê°„ íŠ¸ë¦¬ì˜ ë…¸ë“œì— í¬í•¨ëœ êµ¬ê°„ë“¤ì˜ í•©ì§‘í•©ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´ `[0, 10]`ìœ¼ë¡œ ë§Œë“  êµ¬ê°„ íŠ¸ë¦¬ì—ì„œ `[3, 7]`ì€ `[2], [3, 5], [6, 7]`ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.

## íŠ¹ì • êµ¬ê°„ì˜ ìµœì†Œì¹˜ë¥¼ ì°¾ëŠ” êµ¬ê°„ íŠ¸ë¦¬ êµ¬í˜„
ìœ„ì—ì„œ ë“¤ì—ˆë˜ ì˜ˆì‹œë¥¼ êµ¬í˜„í•´ë³´ì. 

ë¨¼ì € íŠ¸ë¦¬ë¥¼ ì €ì •í•  ë°°ì—´ì„ ë§Œë“¤ì–´ì•¼ í•œë‹¤. ë°°ì—´ì—ëŠ” ëª¨ë“  ë…¸ë“œê°€ ë“¤ì–´ê°ˆ ìˆ˜ ìˆì„ ë§Œí¼ ì¶©ë¶„íˆ í° í¬ê¸°ì—¬ì•¼ í•œë‹¤.
ë°°ì¼ì˜ ê¸¸ì´ì™€ ê°€ì¥ ê°€ê¹Œìš´ 2ì˜ ì œê³±ìœ¼ë¡œ ì˜¬ë¦¼í•œ ë’¤ 2ë¥¼ ê³±í•˜ê±°ë‚˜, ê·€ì°®ë‹¤ë©´ ê·¸ëƒ¥ 4ë°° í•´ì£¼ë©´ ëœë‹¤.

> ì˜ˆì‹œì—ì„œëŠ” ë°°ì—´ì˜ ê¸¸ì´ë¼ 10ì´ë¼ê³  ê°€ì •í•œë‹¤.

ì´ì œ êµ¬ê°„ íŠ¸ë¦¬ë¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤. í˜„ì¬ ë…¸ë“œì— ì €ì¥í•œ ê°’ì€ ì™¼ìª½ê³¼ ì˜¤ë¥¸ìª½ ìì‹ ì¤‘ ë” ì‘ì€ ê²ƒì„ ì €ì¥í•˜ë©´ ëœë‹¤.

```js
const segmentTree = Array(10 * 4);
function init(start, end, node) {
    if(start === end) return segmentTree[node] = arr[start];
    const mid = Math.floor((start + end) / 2);
    return segmentTree[node] = Math.min(init(start, mid, node * 2), init(mid + 1, end, node * 2 + 1));
}
```

êµ¬ê°„ íŠ¸ë¦¬ë¥¼ ì´ˆê¸°í™” ê³¼ì •ì€ $O(N)$ì˜ ì‹œê°„ ë³µì¡ë„ë¥¼ ê°€ì§„ë‹¤.

ì„ì˜ì˜ êµ¬ê°„ì— ëŒ€í•´ ì§ˆì˜í•˜ê¸° ìœ„í•œ ì¤€ë¹„ëŠ” ëª¨ë‘ ë§ˆì³¤ë‹¤.
ì´ì œ ì§ˆì˜ë¥¼ í•´ë³´ì. ìœ„ì—ì„œ ì„ì˜ì˜ êµ¬ê°„ì€ êµ¬ê°„ íŠ¸ë¦¬ ë…¸ë“œì˜ í•©ì§‘í•©ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤ê³  í–ˆë‹¤.
ì¦‰, `start`ì™€ `end`ê°€ ë²”ìœ„ ì•ˆì— ìˆëŠ” ê²½ìš°ë§Œ ì°¾ì•„ì£¼ë©´ ëœë‹¤.

```js
function query(left, right) {
    function helper(start, end, node, left, right) {
        // ë²”ìœ„ ë°–
        if (end < left || right < start) return Infinity;
        // ë²”ìœ„ ì•ˆ
        if (left <= start && end <= right) return segmentTree[node];
        // ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ì–´ êµ¬í•¨
        const mid = Math.floor((start + end) / 2);
        return Math.min(
            helper(start, mid, node * 2, left, right),
            helper(mid + 1, end, node * 2 + 1, left, right)
        );
    }
    return helper(0, 9, 1, left, right);
}
```

íŠ¸ë¦¬ì— ëŒ€í•œ ì§ˆì˜ëŠ” $O(\log N)$ì˜ ì‹œê°„ ë³µì¡ë„ë¥¼ ê°€ì§€ê²Œ ëœë‹¤.

ë§Œì•½ ë°°ì—´ì˜ ìš”ì†Œê°€ ìˆ˜ì •ë˜ë©´ ì–´ë–»ê²Œ í• ê¹Œ?
ì´ë•ŒëŠ” í•´ë‹¹ ìš”ì†Œë¥¼ í¬í•¨í•˜ê³  ë…¸ë“œë“¤ë§Œ ê°±ì‹ í•´ì£¼ë©´ ëœë‹¤.

```js
function update(target, newValue) {
    function helper(start, end, node, target, newValue) {
        // í•´ë‹¹ êµ¬ê°„ê³¼ ìƒê´€ ì—†ìœ¼ë©´ ë¬´ì‹œ
        if(target < start || end < target) return segmentTree[node];
        // ë¦¬í”„ ë…¸ë“œë©´ ê°±ì‹ 
        if(start === end) return segmentTree[node] = newValue;
        const mid = Math.floor((start + end) / 2);
        return segmentTree[node] = Math.min(
            helper(start, mid, node * 2, target, newValue),
            helper(mid + 1, end, node * 2 + 1, target, newValue),
        )
    }
    return helper(0, 9, 1, target, newValue);
}
```

íŠ¸ë¦¬ì— ëŒ€í•œ ìˆ˜ì • ë˜í•œ $O(\log N)$ì˜ ì‹œê°„ ë³µì¡ë„ë¥¼ ê°€ì§€ê²Œ ëœë‹¤.

## ë§ˆì¹˜ë©°
ë§Œì•½ ì–´ë–¤ êµ¬ê°„ì— ëŒ€í•œ ì§ˆì˜ë¥¼ ìì£¼ í•´ì•¼í•˜ëŠ” ìƒí™©ì´ë¼ë©´ êµ¬ê°„ íŠ¸ë¦¬ë¥¼ í™œìš©í•´ ë¹ ë¥´ê²Œ ì²˜ë¦¬í•´ë³´ì.

<br/>

ì°¸ì¡°:  
<https://m.blog.naver.com/PostView.naver?blogId=ndb796&logNo=221282210534&referrerCode=0&searchKeyword=%EA%B5%AC%EA%B0%84%20%ED%8A%B8%EB%A6%AC>  
í”„ë¡œê·¸ë˜ë° ëŒ€íšŒì—ì„œ ë°°ìš°ëŠ” ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ í•´ê²° ì „ëµ